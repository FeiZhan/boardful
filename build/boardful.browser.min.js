/*! boardful browser 2015-01-21 */
var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Board=function(a,b){this.type="Board",this.owner=b,this.name=a.name,BOARDFUL.Mngr.add(this),this.config=a},BOARDFUL.ENGINE.Board.prototype.load=function(){BOARDFUL.Cmdline.output("loading board",this.config.name);{var a=this;new BOARDFUL.ENGINE.FileLoader([this.config["package"]],function(){var b=BOARDFUL.ENGINE.FileList[BOARDFUL.ENGINE.FileNameList[a.config["package"]]].content;a.createRoom(b)})}},BOARDFUL.ENGINE.Board.prototype.createRoom=function(a){var b=new BOARDFUL.ENGINE.Room(a,this.id);b.configRoom()};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.run=function(a){switch(BOARDFUL.init(),BOARDFUL.Mngr=new BOARDFUL.ENGINE.Manager,BOARDFUL.loadBoards(),BOARDFUL.Logger.log("info","launch type",a),a){case"server":BOARDFUL.SERVER.port=process.argv[3]||8080,BOARDFUL.SERVER.createServer();break;case"browser":BOARDFUL.MENUS.run();break;case"desktop":default:global.jquery=require("jquery"),global.$=jquery.create(),BOARDFUL.Cmdline=new BOARDFUL.DESKTOP.Cmdline,BOARDFUL.DESKTOP.Cmdline.setCmdline(),BOARDFUL.DESKTOP.Cmdline.showMenu()}},BOARDFUL.init=function(){BOARDFUL.ENGINE.checkEnvi(),BOARDFUL.Logger=new BOARDFUL.ENGINE.Logger,BOARDFUL.Logger.add(winston.transports.File,{filename:"logs/boardful.log"}).remove(winston.transports.Console),BOARDFUL.Logger.log("info","----------launch----------"),BOARDFUL.Debugger=new BOARDFUL.ENGINE.Logger,BOARDFUL.Debugger.add(winston.transports.File,{filename:"logs/debug.log"}).remove(winston.transports.Console),BOARDFUL.Debugger.log("info","----------launch----------"),BOARDFUL.Logger.log("info","environment",BOARDFUL.ENGINE.Envi),BOARDFUL.ENGINE.initFileMngr(),"browser"==BOARDFUL.ENGINE.Envi.type&&(BOARDFUL.urlparam=BOARDFUL.ENGINE.parseUrl(),BOARDFUL.Logger.log("info","url param",BOARDFUL.urlparam),BOARDFUL.ENGINE.getFilesInHtml())},BOARDFUL.BoardList=new Array,BOARDFUL.loadBoards=function(){console.log("loading Boardful");new BOARDFUL.ENGINE.FileLoader(["src/engine/gamelist.json"],function(){var a=BOARDFUL.ENGINE.FileList[BOARDFUL.ENGINE.FileNameList["src/engine/gamelist.json"]].content.games;for(var b in a)BOARDFUL.BoardList.push(new BOARDFUL.ENGINE.Board(a[b]))})};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Card=function(a){this.type="Card",this.rank=a.rank,this.suit=a.suit,this.color=a.color,this.name="card_"+this.rank+"_"+this.suit,this.owner=void 0,BOARDFUL.Mngr.add(this)},BOARDFUL.ENGINE.Card.load=function(a){var b=new Array;switch(a){case"poker":b=(new BOARDFUL.BOARDS.Poker).card_list}return b};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Command=new Object,BOARDFUL.ENGINE.Command.call=function(a){var b=a.split();if(0!=b.length)return a=b[0],b=b.shift(),a in BOARDFUL.ENGINE.Command.list?BOARDFUL.ENGINE.Command.list[a](b):void console.log("unknow cmd",a)},BOARDFUL.ENGINE.Command.list={why:function(){console.log("because I am rich and bitch")}};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Deck=function(a){this.type="Deck",this.card_list=new Array,this.owner=a,BOARDFUL.Mngr.add(this),this.addListeners()},BOARDFUL.ENGINE.Deck.prototype.addListeners=function(){var a=this;BOARDFUL.Mngr.get(this.owner).event_mngr.on("CreateDeck",{level:"game",callback:function(b){a.createDeck(b)},id:a.id}),BOARDFUL.Mngr.get(this.owner).event_mngr.on("ShuffleDeck",{level:"game",callback:function(b){a.shuffleDeck(b)},id:a.id}),BOARDFUL.Mngr.get(this.owner).event_mngr.on("DealCards",{level:"game",callback:function(b){a.dealCards(b)},id:a.id})},BOARDFUL.ENGINE.Deck.prototype.createDeck=function(a){if(a.deck==this.id){var b=BOARDFUL.ENGINE.Card.load(a.type);BOARDFUL.Mngr.get(a.deck).getCards(b);var c=new Array,d=new BOARDFUL.ENGINE.Event({name:"CreateDeckUi",source:this.id,cards:b});c.push(d.id),BOARDFUL.Mngr.get(this.owner).event_mngr.front(c)}},BOARDFUL.ENGINE.Deck.prototype.shuffleDeck=function(a){if(a.deck==this.id){this.card_list=BOARDFUL.ENGINE.shuffle(this.card_list);var b=new Array,c=new BOARDFUL.ENGINE.Event({name:"ShuffleDeckUi",source:this.id,cards:this.card_list});b.push(c.id),BOARDFUL.Mngr.get(this.owner).event_mngr.front(b)}},BOARDFUL.ENGINE.Deck.prototype.getCards=function(a){for(var b in a)BOARDFUL.Mngr.get(a[b]).owner=this.id;this.card_list=this.card_list.concat(a)},BOARDFUL.ENGINE.Deck.prototype.dealCards=function(a){if(a.deck==this.id){for(var b=new Array,c=0;c<a.number;++c)b.push(this.card_list[0]),this.card_list.shift();BOARDFUL.Mngr.get(a.player).hand=BOARDFUL.Mngr.get(a.player).hand.concat(b);var d=new Array,e=new BOARDFUL.ENGINE.Event({name:"DealCardsUi",source:this.id,cards:b});d.push(e.id),BOARDFUL.Mngr.get(this.owner).event_mngr.front(d)}};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Event=function(a){this.type="Event",this.owner=void 0,BOARDFUL.Mngr.add(this),this.name=a.name,this.arg=a,this.arg.creation_time=new Date},BOARDFUL.ENGINE.EVENT_LEVELS=["top","system","server","board","room","game","extension","player","card","rear"],BOARDFUL.ENGINE.EventMngr=function(a){this.type="EventMngr",this.owner=a,BOARDFUL.Mngr.add(this),this.list=new Array,this.listener_list=new Object,this.timeout=100,this.logger=new BOARDFUL.ENGINE.Logger,this.logger.add(winston.transports.File,{filename:"logs/event.log"}).remove(winston.transports.Console),this.logger.log("info","----------launch----------")},BOARDFUL.ENGINE.EventMngr.prototype.front=function(a){if(void 0===a){if(0==this.list.length)return void 0}else"array"==typeof a||"object"==typeof a?(this.list=a.concat(this.list),this.logger.log("info","prepend events",a)):(this.list.unshift(a),this.logger.log("info","prepend event",a));return BOARDFUL.Mngr.get(this.list[0])},BOARDFUL.ENGINE.EventMngr.prototype.add=function(a){"array"==typeof a||"object"==typeof a?(this.list=this.list.concat(a),this.logger.log("info","append events",a)):(this.list.push(a),this.logger.log("info","append event",a))},BOARDFUL.ENGINE.EventMngr.prototype.on=function(a,b){a in this.listener_list||(this.listener_list[a]=new Object),b.level=b.level||"rear",b.level in this.listener_list[a]||(this.listener_list[a][b.level]=new Array),this.listener_list[a][b.level].push(b),this.logger.log("info","add listener",a)},BOARDFUL.ENGINE.EventMngr.prototype.off=function(a,b){if(a in this.listener_list&&(b.level=b.level||"extension",b.level in this.listener_list[a])){var c=this.listener_list[a][b.level].indexOf(b);c>=0&&this.listener_list[a][b.level].splice(c,1)}},BOARDFUL.ENGINE.EventMngr.prototype.run=function(){switch(BOARDFUL.Mngr.get(this.owner).status){case"pause":case"exit":break;case"run":default:if(this.list.length>0){var a=this.front();if(this.logger.log("info","event",a.name),this.list.shift(),a&&a.name in this.listener_list)for(var b in BOARDFUL.ENGINE.EVENT_LEVELS)if(BOARDFUL.ENGINE.EVENT_LEVELS[b]in this.listener_list[a.name])for(var c in this.listener_list[a.name][BOARDFUL.ENGINE.EVENT_LEVELS[b]]){var d=this.listener_list[a.name][BOARDFUL.ENGINE.EVENT_LEVELS[b]][c];this.logger.log("info","trigger",d),d.callback(a.arg)}}}var e=this;setTimeout(function(){e.run()},this.timeout)};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.initFileMngr=function(){BOARDFUL.ENGINE.FileLogger=new BOARDFUL.ENGINE.Logger,BOARDFUL.ENGINE.FileLogger.add(winston.transports.File,{filename:"logs/file.log"}).remove(winston.transports.Console),BOARDFUL.ENGINE.FileLogger.log("info","----------launch----------")},BOARDFUL.ENGINE.FileList=new Object,BOARDFUL.ENGINE.FileNameList=new Object,BOARDFUL.ENGINE.NextFileId=0,BOARDFUL.ENGINE.addToFileList=function(a,b,c){a in BOARDFUL.ENGINE.FileNameList?BOARDFUL.ENGINE.FileList[BOARDFUL.ENGINE.FileNameList[a]]={name:a,content:b,status:c}:(BOARDFUL.ENGINE.FileList[BOARDFUL.ENGINE.NextFileId]={name:a,type:"",content:b,status:c},BOARDFUL.ENGINE.FileNameList[a]=BOARDFUL.ENGINE.NextFileId,++BOARDFUL.ENGINE.NextFileId)},BOARDFUL.ENGINE.getFilesInHtml=function(){$("script").each(function(){BOARDFUL.ENGINE.addToFileList($(this).attr("src"),$(this),"loaded")}),BOARDFUL.ENGINE.FileLogger.log("info","files in html",BOARDFUL.ENGINE.FileNameList)},BOARDFUL.ENGINE.loadFile=function(a){switch(BOARDFUL.ENGINE.Envi.type){case"browser":BOARDFUL.ENGINE.loadFileAjax(a);break;case"nodejs":try{var b=require("../"+a);BOARDFUL.ENGINE.addToFileList(a,b,"loaded"),BOARDFUL.ENGINE.FileLogger.log("info","file loaded",a)}catch(c){BOARDFUL.ENGINE.addToFileList(a,"","failed"),BOARDFUL.ENGINE.FileLogger.log("info","file failed",a,c)}}},BOARDFUL.ENGINE.loadFileAjax=function(a){".js"==a.substr(a.length-3)?$.getScript(a).done(function(b){BOARDFUL.ENGINE.addToFileList(a,b,"loaded"),BOARDFUL.ENGINE.FileLogger.log("info","js loaded",a)}).fail(function(){BOARDFUL.ENGINE.addToFileList(a,"","failed"),BOARDFUL.ENGINE.FileLogger.log("info","js failed",a)}):".css"==a.substr(a.length-4)?($("head").append($('<link rel="stylesheet" type="text/css" />').attr("href",a)),BOARDFUL.ENGINE.addToFileList(a,"","loaded"),BOARDFUL.ENGINE.FileLogger.log("info","css loaded"),BOARDFUL.ENGINE.FileLogger.log("info",a)):".json"==a.substr(a.length-5)?$.getJSON(a,function(b){BOARDFUL.ENGINE.addToFileList(a,b,"loaded"),BOARDFUL.ENGINE.FileLogger.log("info","json loaded",a)}).fail(function(){BOARDFUL.ENGINE.addToFileList(a,"","failed"),BOARDFUL.ENGINE.FileLogger.log("info","json failed",a)}).always(function(){}):(BOARDFUL.ENGINE.addToFileList(a,"","failed"),BOARDFUL.ENGINE.FileLogger.log("info","file unknown",a))},BOARDFUL.ENGINE.FileLoader=function(a,b){this.list=a,this.callback=b,this.done=!1,this.load()},BOARDFUL.ENGINE.FileLoader.prototype.load=function(){BOARDFUL.ENGINE.FileLogger.log("info","loading",this.list),this.done=!0;for(var a in this.list)this.list[a]in BOARDFUL.ENGINE.FileNameList&&"loaded"==BOARDFUL.ENGINE.FileList[BOARDFUL.ENGINE.FileNameList[this.list[a]]].status||(this.done=!1,BOARDFUL.ENGINE.loadFile(this.list[a]));var b=this;this.done?this.callback():setTimeout(function(){b.load()},500)};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Game=function(a){if(this.type="Game",this.owner=void 0,BOARDFUL.Mngr.add(this),this.event_mngr=new BOARDFUL.ENGINE.EventMngr(this.id),this.ui=new BOARDFUL.DESKTOP.Cmdline(this.id),this.status="init",a instanceof BOARDFUL.ENGINE.Room){this.config=a.config,this.options=a.options,this.deck_list={draw:new BOARDFUL.ENGINE.Deck(this.id).id,discard:new BOARDFUL.ENGINE.Deck(this.id).id},this.table=new BOARDFUL.ENGINE.Table(this.id).id,this.player_list=new Array,this.current_player=-1;for(var b in a.player_list){var c=new BOARDFUL.ENGINE.Player(a.player_list[b],this.id);this.player_list.push(c.id)}}this.addListeners()},BOARDFUL.ENGINE.Game.prototype.addListeners=function(){var a=this;this.event_mngr.on("StartGame",{level:"game",callback:function(b){a.start(b)},id:a.id}),this.event_mngr.on("ShufflePlayers",{level:"game",callback:function(b){a.shufflePlayers(b)},id:a.id}),this.event_mngr.on("StartRound",{level:"game",callback:function(b){a.startRound(b)},id:a.id}),this.event_mngr.on("EndRound",{level:"game",callback:function(b){a.endRound(b)},id:a.id}),this.event_mngr.on("StartPlayer",{level:"game",callback:function(b){a.startPlayer(b)},id:a.id})},BOARDFUL.ENGINE.Game.prototype.run=function(){this.status="run";var a=new BOARDFUL.ENGINE.Event({name:"StartGame",source:this.id});this.event_mngr.add(a.id),this.event_mngr.run()},BOARDFUL.ENGINE.Game.prototype.pause=function(){switch(this.status){case"init":case"exit":case"pause":break;default:this.status="pause",console.log("game pause")}},BOARDFUL.ENGINE.Game.prototype.resume=function(){switch(this.status){case"init":case"exit":break;case"pause":this.status="run",console.log("game resume")}},BOARDFUL.ENGINE.Game.prototype.start=function(){this.round=0;var a=new Array,b=new BOARDFUL.ENGINE.Event({name:"ShufflePlayers",source:this.id});a.push(b.id),b=new BOARDFUL.ENGINE.Event({name:"CreateDeck",source:this.id,deck:this.deck_list.draw,type:"poker"}),a.push(b.id),b=new BOARDFUL.ENGINE.Event({name:"ShuffleDeck",source:this.id,deck:this.deck_list.draw}),a.push(b.id);for(var c in this.player_list){var b=new BOARDFUL.ENGINE.Event({name:"DealCards",source:this.id,deck:this.deck_list.draw,player:this.player_list[c],number:5});a.push(b.id)}b=new BOARDFUL.ENGINE.Event({name:"StartRound",source:this.id}),a.push(b.id),this.event_mngr.front(a)},BOARDFUL.ENGINE.Game.prototype.shufflePlayers=function(){this.player_list=BOARDFUL.ENGINE.shuffle(this.player_list);var a=new Array,b=new BOARDFUL.ENGINE.Event({name:"ShufflePlayersUi",source:this.id,players:this.player_list});a.push(b.id),this.event_mngr.front(a)},BOARDFUL.ENGINE.Game.prototype.startRound=function(){++this.round,console.log("round",this.round);var a,b=new Array;for(var c in this.player_list)a=new BOARDFUL.ENGINE.Event({name:"StartPlayer",source:this.id,player:this.player_list[c]}),b.push(a.id),a=new BOARDFUL.ENGINE.Event({name:"StartPlayer"+this.player_list[c],source:this.id,player:this.player_list[c]}),b.push(a.id),a=new BOARDFUL.ENGINE.Event({name:"DealCards",source:this.id,deck:this.deck_list.draw,player:this.player_list[c],number:2}),b.push(a.id),a=new BOARDFUL.ENGINE.Event({name:"PlayersDuel",source:this.id}),b.push(a.id);a=new BOARDFUL.ENGINE.Event({name:"EndRound",source:this.id}),b.push(a.id),this.event_mngr.front(b)},BOARDFUL.ENGINE.Game.prototype.endRound=function(){var a=new BOARDFUL.ENGINE.Event({name:"StartRound",source:this.id});this.event_mngr.add(a.id)},BOARDFUL.ENGINE.Game.prototype.startPlayer=function(){this.current_player=(this.current_player+1)%this.player_list.length};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Logger=function(){var a;switch(BOARDFUL.ENGINE.Envi.type){case"nodejs":global.winston=require("winston"),a=new BOARDFUL.ENGINE.WinstonLogger({transports:[new winston.transports.Console]});break;case"browser":a=new BOARDFUL.ENGINE.DefaultLogger;break;default:a=new BOARDFUL.ENGINE.DefaultLogger}return a},BOARDFUL.ENGINE.DefaultLogger=function(){return console},BOARDFUL.ENGINE.DefaultLogger.prototype.add=function(){return this},BOARDFUL.ENGINE.DefaultLogger.prototype.remove=function(){return this},BOARDFUL.ENGINE.WinstonLogger=function(a){return this.winston=new winston.Logger(a),this.winston.log_base=this.winston.log,this.winston.log=function(){if("nodejs"==BOARDFUL.ENGINE.Envi.type)for(var a in arguments)("array"==typeof arguments[a]||"object"==typeof arguments[a]||"function"==typeof arguments[a])&&(arguments[a]=BOARDFUL.ENGINE.toString(arguments[a]));return this.log_base.apply(this,arguments)},this.winston};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Manager=function(){this.logger=new BOARDFUL.ENGINE.Logger,this.logger.add(winston.transports.File,{filename:"logs/mngr.log"}).remove(winston.transports.Console),this.logger.log("info","----------launch----------"),this.next_id=0,this.list=new Object},BOARDFUL.ENGINE.Manager.prototype.get=function(a){return this.list[a]},BOARDFUL.ENGINE.Manager.prototype.add=function(a){return a.id=this.next_id,a.type=a.type||a.constructor.name,"name"in a||(a.name=a.type+"_"+a.id),++this.next_id,this.list[a.id]=a,this.logger.log("info","add",a.name,a),a.id};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Player=function(a,b){switch(this.type="Player",this.owner=b,this.game=BOARDFUL.Mngr.get(this.owner),this.hand=new Array,this.turn=void 0,this.name=void 0,a){case"me":this.name="me";break;case"ai":this.name="ai";break;default:this.name="unknown_player"}BOARDFUL.Mngr.add(this),this.addListeners()},BOARDFUL.ENGINE.Player.prototype.addListeners=function(){var a=this;this.game.event_mngr.on("StartPlayer"+this.id,{level:"game",callback:function(b){a.start(b)},id:a.id}),this.game.event_mngr.on("Player"+this.id+"PlayCard",{level:"game",callback:function(b){a.playCard(b)},id:a.id})},BOARDFUL.ENGINE.Player.prototype.start=function(){var a=new BOARDFUL.ENGINE.Event({name:"PlayerEnd",source:this.id});this.game.event_mngr.front(a.id)},BOARDFUL.ENGINE.Player.prototype.playCard=function(a){if(0!=this.hand.length){var b=this.hand[Math.floor(Math.random()*this.hand.length)],c=new BOARDFUL.ENGINE.Event({name:"PlaceCardOnTable",source:this.id,source_event:a.source_event,player:this.id,card:b});this.game.event_mngr.front(c.id)}};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Room=function(a,b){this.type="Room",this.owner=b,BOARDFUL.Mngr.add(this),this.config=a,this.options=a.options,this.player_list=a.player_list||["me","ai"]},BOARDFUL.ENGINE.Room.prototype.configRoom=function(){BOARDFUL.Cmdline.output("config room");var a=this;process.stdin.once("data",function(){BOARDFUL.Cmdline.output("config room done");var b=new BOARDFUL.ENGINE.Game(a);BOARDFUL.Cmdline.output("game start"),b.run()})};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.Table=function(a){this.type="Table",this.owner=a,BOARDFUL.Mngr.add(this),this.arg_list=new Array,this.addListeners()},BOARDFUL.ENGINE.Table.prototype.addListeners=function(){var a=this;BOARDFUL.Mngr.get(this.owner).event_mngr.on("PlayersDuel",{level:"game",callback:function(b){a.playersDuel(b)},id:a.id}),BOARDFUL.Mngr.get(this.owner).event_mngr.on("PlaceCardOnTable",{level:"game",callback:function(b){a.placeCardOnTable(b)},id:a.id}),BOARDFUL.Mngr.get(this.owner).event_mngr.on("SettlePlayersDuel",{level:"game",callback:function(b){a.settlePlayersDuel(b)},id:a.id})},BOARDFUL.ENGINE.Table.prototype.playersDuel=function(){var a,b=new Array;for(var c in BOARDFUL.Mngr.get(this.owner).player_list)a=new BOARDFUL.ENGINE.Event({name:"Player"+BOARDFUL.Mngr.get(this.owner).player_list[c]+"PlayCard",source:this.id,source_event:"PlayersDuel",player:BOARDFUL.Mngr.get(this.owner).player_list[c],number:1}),b.push(a.id);a=new BOARDFUL.ENGINE.Event({name:"SettlePlayersDuel",source:this.id,source_event:"PlayersDuel"}),b.push(a.id),BOARDFUL.Mngr.get(this.owner).event_mngr.front(b)},BOARDFUL.ENGINE.Table.prototype.placeCardOnTable=function(a){var b=BOARDFUL.Mngr.get(a.player).hand.indexOf(a.card);BOARDFUL.Mngr.get(a.player).hand.splice(b,1),this.arg_list.push(a)},BOARDFUL.ENGINE.Table.prototype.settlePlayersDuel=function(){var a=new Array;for(var b in this.arg_list)"PlayersDuel"==this.arg_list[b].source_event&&a.push(b);var c=this;a.sort(function(a,b){return BOARDFUL.BOARDS.Poker.compare(c.arg_list[a].card,c.arg_list[b].card)});var d=new Array,e=new Array;for(var b in a)d.push(this.arg_list[a[b]].player),e.push(this.arg_list[a[b]].card);var f=void 0;a.length>0&&(f=this.arg_list[a[a.length-1]].player);var g=new Array,h=new BOARDFUL.ENGINE.Event({name:"SettlePlayersDuelUi",source:this.id,cards:e,players:d,player:f});g.push(h.id),BOARDFUL.Mngr.get(this.owner).event_mngr.front(g);for(var b=a.length-1;b>=0;--b)this.arg_list.splice(a[b],1)};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.ENGINE=BOARDFUL.ENGINE||new Object,BOARDFUL.ENGINE.getFunctionFromString=function(a){var b=window,c=a.split(".");for(i=0;i<c.length-1;i++)if(b=b[c[i]],void 0==b)return;return b[c[c.length-1]]},BOARDFUL.ENGINE.toString=function(a){var b=a;try{b=JSON.stringify(a)}catch(c){if("array"==typeof a||"object"==typeof a||"function"==typeof a){b="{";for(var d in a){if(b+=d+":","array"==typeof a[d]||"object"==typeof a[d]||"function"==typeof a[d]){b+="{";for(var e in a[d])b+=e+":",b+="array"==typeof a[d][e]||"object"==typeof a[d][e]||"function"==typeof a[e]?typeof a[d][e]:a[d][e],b+=",";b+="}"}else b+=a[d];b+=","}b+="}"}else b=""+a}return b},BOARDFUL.ENGINE.Envi=new Object,BOARDFUL.ENGINE.checkEnvi=function(){"undefined"!=typeof module&&module.exports?BOARDFUL.ENGINE.Envi.type="nodejs":(BOARDFUL.ENGINE.Envi.type="browser",BOARDFUL.ENGINE.Envi.isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,BOARDFUL.ENGINE.Envi.isFirefox="undefined"!=typeof InstallTrigger,BOARDFUL.ENGINE.Envi.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,BOARDFUL.ENGINE.Envi.isChrome=!!window.chrome&&!isOpera,BOARDFUL.ENGINE.Envi.isIE=!1||!!document.documentMode)},BOARDFUL.ENGINE.parseUrlParam=function(a){for(var b={},a=a||window.location.search.substring(1),c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if("undefined"==typeof b[e[0]])b[e[0]]=e[1];else if("string"==typeof b[e[0]]){var f=[b[e[0]],e[1]];b[e[0]]=f}else b[e[0]].push(e[1])}return b},BOARDFUL.ENGINE.parseUrl=function(){var a=BOARDFUL.ENGINE.parseUrlParam(window.location.search.substring(1));a["#"]=window.location.hash.substring(1);var b=BOARDFUL.ENGINE.parseUrlParam(window.location.hash.substring(1));for(var c in b)c in a||(a[c]=b[c]);return a},BOARDFUL.ENGINE.shuffle=function(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.GAME=BOARDFUL.GAME||new Object,BOARDFUL.GAME.init=function(){$("#content").empty(),$("#content").load("src/browser/game.html");new BOARDFUL.ENGINE.loadFileList(["src/browser/game.css"],function(){});$("#content button#ok").on("click",function(){})};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.MENUS=BOARDFUL.MENUS||new Object,BOARDFUL.MENUS.GameList=new Object,BOARDFUL.MENUS.run=function(){$("#content").empty(),$("#content").load("src/browser/menu0.html");new BOARDFUL.ENGINE.loadFileList(["src/browser/menu0.css","src/engine/gamelist.json"],function(){BOARDFUL.MENUS.GameList=BOARDFUL.ENGINE.FileList[BOARDFUL.ENGINE.FileNameList["src/engine/gamelist.json"]].content.games,BOARDFUL.MENUS.loadGameList(BOARDFUL.MENUS.GameList)})},BOARDFUL.MENUS.Selected=void 0,BOARDFUL.MENUS.loadGameList=function(a){$("#content button#ok").click(function(){void 0!==BOARDFUL.MENUS.Selected&&BOARDFUL.MENUS.Selected in BOARDFUL.MENUS.GameList&&BOARDFUL.MENUS.roomStart(BOARDFUL.MENUS.GameList[BOARDFUL.MENUS.Selected])});for(var b in a)$("#content #gamelist ul").append('<li id="'+b+'">'+a[b].name+"</li>"),$("#content #gamelist ul li:last").click(function(){BOARDFUL.MENUS.Selected=$(this).attr("id"),$("#content #gamelist li").removeClass("active"),$(this).addClass("active"),$("#content #descrip").empty(),$("#content #descrip").append(a[BOARDFUL.MENUS.Selected].descrip)})};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.MENUS=BOARDFUL.MENUS||new Object,BOARDFUL.MENUS.GamePackage=new Object,BOARDFUL.MENUS.roomStart=function(a){$("#content").empty(),$("#content").load("src/browser/menu1.html");new BOARDFUL.ENGINE.loadFileList(["src/browser/menu1.css",a["package"]],function(){BOARDFUL.MENUS.GamePackage=BOARDFUL.ENGINE.FileList[BOARDFUL.ENGINE.FileNameList[a["package"]]].content,BOARDFUL.MENUS.setRoom(BOARDFUL.MENUS.GamePackage)})},BOARDFUL.MENUS.setRoom=function(a){$("#content button#ok").on("click",function(){BOARDFUL.GAME.init(BOARDFUL.MENUS.GamePackage)}),$("#content #name").html(a.name),$("#content #descrip1").html(a.descrip),$("#content #players").append("<div><span>me</span></div>");for(var b=1;b<a.max_players;++b)$("#content #players").append("<div><span>empty</span></div>");for(var b in a.options){$("#content #options").append('<div id="'+b+'"></div>'),$("#content #options #"+b).append("<span>"+b+"</span><select></select>");for(var c in a.options[b].value)$("#content #options #"+b+" select").append('<option value="'+a.options[b].value[c]+'">'+a.options[b].value[c]+"</option>")}};