/*! boardful browser 2015-01-30 */
var BOARDFUL=BOARDFUL||new Object;BOARDFUL.BRSR=BOARDFUL.BRSR||new Object,BOARDFUL.BRSR.CardUi=function(a,b){this.type="CardUi",this.instance=a,this.owner=b,BOARDFUL.Mngr.add(this);new BOARDFUL.CORE.FileLoader(["src/browser/card.html","src/browser/card.css"],function(){})},BOARDFUL.BRSR.CardUi.prototype.load=function(a,b){a=a||new Object,a.parent=a.parent||"";var c=this;$.get("src/browser/card.html",function(d){$("#content "+a.parent).append(d).fadeIn("slow"),$("#content "+a.parent+" .card:last").attr("id",c.id);var e=$("#content #"+c.id);a.position&&e.css(a.position),e.find("h4").html(BOARDFUL.Mngr.get(c.instance).name);var f;e.draggable({revert:"invalid",start:function(){f=setInterval(function(){e.toggleClass("flip")},2e3)},drag:function(){},stop:function(){clearInterval(f),e.removeClass("flip")}}),e.hover(function(){!$(".boardful #detail").hasClass("active")},function(){$(".boardful #detail").hasClass("active")&&$(".boardful #detail").removeClass("active").fadeOut("fast")}),"function"==typeof b&&b(e)})},BOARDFUL.BRSR.CardUi.prototype.move=function(a){var b=$("#content #"+this.id);if(0==b.length){var c=this;this.load({position:{top:"50%",left:"80%"}},function(){c.move(a)})}else b.animate({top:a.position.top,left:a.position.left},"slow",function(){b.css({top:"auto",left:"auto"});var c=b.detach();$("#content #"+a.dom_id).append(c)})};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.BRSR=BOARDFUL.BRSR||new Object,BOARDFUL.BRSR.GameUi=function(a){this.type="GameUi",this.instance=a,BOARDFUL.Mngr.add(this),BOARDFUL.CORE.Command.owner=this.instance,this.addListeners(),$("#"+BOARDFUL.BRSR.Canvas).empty();var b=this;$("#"+BOARDFUL.BRSR.Canvas).hide().load("src/browser/game.html",function(){$(this).fadeIn("slow"),$("#"+BOARDFUL.BRSR.Canvas+" #playerok").on("click",function(){if("userinput"==BOARDFUL.Mngr.get(b.instance).status)for(var a in b.player_list)"me"==BOARDFUL.Mngr.get(BOARDFUL.Mngr.get(b.player_list[a]).instance).name&&BOARDFUL.Mngr.get(b.player_list[a]).playerOk()}),$("#"+BOARDFUL.BRSR.Canvas+" #chat div").on("click",function(){$(this).toggleClass("disable")}),$("#"+BOARDFUL.BRSR.Canvas+" #table").droppable({drop:function(a,c){b.dropCardOnTable(a,c,this)}})}),this.player_list=new Array;for(var c in BOARDFUL.Mngr.get(this.instance).player_list)this.player_list.push(new BOARDFUL.BRSR.PlayerUi(BOARDFUL.Mngr.get(this.instance).player_list[c],this.id).id);new BOARDFUL.CORE.FileLoader(["src/browser/game.html","src/browser/game.css"],function(){})},BOARDFUL.BRSR.GameUi.prototype.dropCardOnTable=function(a,b,c){if("userinput"==BOARDFUL.Mngr.get(this.instance).status){var d=$(b.draggable).detach();d.css({top:"auto",left:"auto"}),$(c).append(d)}},BOARDFUL.BRSR.GameUi.prototype.addListeners=function(){var a=this;BOARDFUL.Mngr.get(this.instance).event_mngr.on("DealCardUi",{level:"game",callback:function(b){a.dealCardUi(b)},id:a.id})},BOARDFUL.BRSR.GameUi.prototype.dealCardUi=function(a){var b=new BOARDFUL.BRSR.CardUi(a.card,this),c=new Object;switch(BOARDFUL.Mngr.get(a.player).name){case"ai":c={top:"10%",left:"45%"},target_dom_id="yourhand";break;case"me":default:c={top:"70%",left:"45%"},target_dom_id="myhand"}b.move({position:c,dom_id:target_dom_id})};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.BRSR=BOARDFUL.BRSR||new Object,BOARDFUL.BRSR.run=function(a){BOARDFUL.BRSR.Canvas=a,$("#"+BOARDFUL.BRSR.Canvas).addClass("boardful"),$("#dialog").dialog({autoOpen:!1,show:{effect:"fadeIn",duration:500},hide:{effect:"fadeOut",duration:500}}),$("#header #options").click(function(){$("#dialog").dialog($("#dialog").dialog("isOpen")?"close":"open")}),$("#header #sound").click(function(){$(this).toggleClass("disable")}),$("#"+BOARDFUL.BRSR.Canvas).empty(),$("#"+BOARDFUL.BRSR.Canvas).hide().load("src/browser/menu0.html",function(){$(this).fadeIn("slow"),$("#"+BOARDFUL.BRSR.Canvas+" #menu0_main #local").click(function(){BOARDFUL.BRSR.loadMenu1()}),$("#"+BOARDFUL.BRSR.Canvas+" #menu0_secondary #options").click(function(){$("#dialog").dialog("open")})});new BOARDFUL.CORE.FileLoader(["src/browser/menu0.html","src/browser/menu0.css"],function(){})},BOARDFUL.BRSR.Selected=void 0,BOARDFUL.BRSR.loadMenu1=function(){$("#"+BOARDFUL.BRSR.Canvas).empty(),$("#"+BOARDFUL.BRSR.Canvas).hide().load("src/browser/menu1.html",function(){$(this).fadeIn("slow"),$("#"+BOARDFUL.BRSR.Canvas+" #ok").click(function(){if(void 0!==BOARDFUL.BRSR.Selected){var a=BOARDFUL.Mngr.get(BOARDFUL.BRSR.Selected);a.load(BOARDFUL.BRSR.loadMenu2)}}),$("#"+BOARDFUL.BRSR.Canvas+" #exit").click(function(){BOARDFUL.BRSR.run(BOARDFUL.BRSR.Canvas)});for(var a in BOARDFUL.BoardList){var b=BOARDFUL.Mngr.get(BOARDFUL.BoardList[a]);$("#"+BOARDFUL.BRSR.Canvas+" #board_list ul").append('<li id="'+BOARDFUL.BoardList[a]+'">'+b.config.name+"</li>"),0==a&&(BOARDFUL.BRSR.Selected=$("#"+BOARDFUL.BRSR.Canvas+" #board_list ul li:last").attr("id"),$("#"+BOARDFUL.BRSR.Canvas+" #board_list ul li:last").addClass("active"),$("#"+BOARDFUL.BRSR.Canvas+" #description div").html(BOARDFUL.Mngr.get(BOARDFUL.BRSR.Selected).config.description)),$("#"+BOARDFUL.BRSR.Canvas+" #board_list ul li:last").click(function(){BOARDFUL.BRSR.Selected=$(this).attr("id"),$("#"+BOARDFUL.BRSR.Canvas+" #board_list li").removeClass("active"),$(this).addClass("active"),$("#"+BOARDFUL.BRSR.Canvas+" #description div").html(BOARDFUL.Mngr.get(BOARDFUL.BRSR.Selected).config.description)})}});new BOARDFUL.CORE.FileLoader(["src/browser/menu1.html","src/browser/menu1.css"],function(){})},BOARDFUL.BRSR.loadMenu2=function(a){var b=BOARDFUL.Mngr.get(a);$("#"+BOARDFUL.BRSR.Canvas).empty(),$("#"+BOARDFUL.BRSR.Canvas).hide().load("src/browser/menu2.html",function(){$(this).fadeIn("slow"),$("#"+BOARDFUL.BRSR.Canvas+" #ok").on("click",function(){var b=new BOARDFUL.CORE.Game(a);b.ui=new BOARDFUL.BRSR.GameUi(b.id),b.run()}),$("#"+BOARDFUL.BRSR.Canvas+" #exit").click(function(){BOARDFUL.BRSR.run(BOARDFUL.BRSR.Canvas)}),$("#"+BOARDFUL.BRSR.Canvas+" #room_config li").on("click",function(){$("#"+BOARDFUL.BRSR.Canvas+" #room_config li").removeClass("active"),$("#"+BOARDFUL.BRSR.Canvas+" #room_config div").removeClass("active"),$(this).addClass("active"),$("#"+BOARDFUL.BRSR.Canvas+" #room_config div#"+$(this).attr("id")).addClass("active")}),$("#"+BOARDFUL.BRSR.Canvas+" #room_config #name").html(b.config.name),$("#"+BOARDFUL.BRSR.Canvas+" #room_config #description2").html(b.config.description),$("#"+BOARDFUL.BRSR.Canvas+" #user_list #players").append('<div class="user"><span>me</span></div>'),$("#"+BOARDFUL.BRSR.Canvas+" #user_list #judges").append('<div class="user"><span>empty</span></div>'),$("#"+BOARDFUL.BRSR.Canvas+" #user_list #audience").append('<div class="user"><span>empty</span></div>');for(var c=1;c<b.config.players[0];++c)$("#"+BOARDFUL.BRSR.Canvas+" #user_list #players").append('<div class="user"><span>empty</span></div>');$("#"+BOARDFUL.BRSR.Canvas+" #user_list .user").on("click",function(){$("#"+BOARDFUL.BRSR.Canvas+" #user_list .user").removeClass("active"),$(this).addClass("active")});for(var c in b.config.options){$("#"+BOARDFUL.BRSR.Canvas+" #room_config").append('<div id="'+c+'"></div>'),$("#"+BOARDFUL.BRSR.Canvas+" #room_config #"+c).append("<span>"+c+"</span><select></select>");for(var d in b.config.options[c].value)$("#"+BOARDFUL.BRSR.Canvas+" #room_config #"+c+" select").append('<option value="'+b.config.options[c].value[d]+'">'+b.config.options[c].value[d]+"</option>")}});new BOARDFUL.CORE.FileLoader(["src/browser/menu2.html","src/browser/menu2.css"],function(){})};var BOARDFUL=BOARDFUL||new Object;BOARDFUL.BRSR=BOARDFUL.BRSR||new Object,BOARDFUL.BRSR.PlayerUi=function(a,b){this.type="PlayerUi",this.instance=a,this.owner=b,BOARDFUL.Mngr.add(this);var c;switch(BOARDFUL.Mngr.get(this.instance).name){case"ai":c="src/browser/player_you.html";break;case"me":default:c="src/browser/player_me.html"}this.addListeners(),this.play_card_arg=void 0,$.get(c,function(a){$("#content").append(a).fadeIn("slow")});new BOARDFUL.CORE.FileLoader(["src/browser/player_me.html","src/browser/player_you.html","src/browser/player.css"],function(){})},BOARDFUL.BRSR.PlayerUi.prototype.addListeners=function(){var a=this;BOARDFUL.Mngr.get(BOARDFUL.Mngr.get(this.instance).owner).event_mngr.on("PlayCardUi",{level:"game",callback:function(b){a.playCardUi(b)},id:a.id})},BOARDFUL.BRSR.PlayerUi.prototype.playCardUi=function(a){a.player==this.instance&&(this.play_card_arg=a,BOARDFUL.Mngr.get(BOARDFUL.Mngr.get(this.instance).owner).status="userinput")},BOARDFUL.BRSR.PlayerUi.prototype.playerOk=function(){if("me"==BOARDFUL.Mngr.get(this.instance).name&&"userinput"==BOARDFUL.Mngr.get(BOARDFUL.Mngr.get(this.instance).owner).status&&void 0!==this.play_card_arg){var a=new Array;if($("#content #table .card").each(function(){a.push(parseInt($(this).attr("id")))}),a.length==this.play_card_arg.number){var b=new BOARDFUL.CORE.Event({name:"PlaceCardOnTable",source:this.instance,player:this.instance,cards:a});BOARDFUL.Mngr.get(BOARDFUL.Mngr.get(this.instance).owner).event_mngr.front(b.id),BOARDFUL.Mngr.get(BOARDFUL.Mngr.get(this.instance).owner).status="run"}}};